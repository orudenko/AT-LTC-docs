## S02E09. Вводная лекция о компьютерной архитектуре

Как многим известно, компьютеры в современном их понимании придумал в 1936 году Алан Тьюринг. Если точнее, Тьюринг придумал математическую модель вычислений (машину Тьюринга) — некое очень простое абстрактное устройство, с помощью которого можно делать (с некоторыми ухищрениями) вычисления произвольной сложности. Устройство выглядит так:

* бесконечная лента ячеек, в каждой их которых может находиться символ из произвольного алфавита. По умолчанию в каждой ячейке находится специальный "пустой" символ. Минимальное количество символов, удовлетворяющее этим критериям — два, например "0" и "1". Но в принципе они могут быть какими угодно.

* _головка_ (воображаемое устройство, которое умеет читать и записывать символы на ленте, а также передвигаться на шаг влево или вправо)

* регистр состояний (отдельная ячейка, в которой может находится символ из отдельного алфавита состояний. Для сколько-нибудь интересных алгоритмов двумя состояниями уже не обойтись, обычно их больше).

* таблица инструкций. Это чистая функция, которая для каждого сочетания "символ на ленте под головкой" + "текущее состояние" выдаёт: символ, который следует записать на ленту вместо текущего, новое состояние, которое следует положить в регистр состояний, и один из вариантов: передвинуть головку влево, передвинуть головку вправо, или остаться на месте.

Машина Тьюринга последовательно:

* читает символ из текущего положения головки на ленте (например, 1)
* читает состояние из регистра состояний (например, A)
* смотрит в таблицу инструкций и видит, есть ли там запись для символа 1 и состояния A; например, такая: 1,A -> 0,B,R. Если есть, записывает в ячейку под головку новый символ (0), в регистр состояний новое состояние (B), и двигает головку в нужном направлении (R, направо). Если в таблице инструкций записи не нашлось, машина останавливается.

С помощью этого нехитрого воображаемого устройства Тьюринг доказал следующее:

1. Хитро подобрав таблицу инструкций, можно произвести _любое_ математическое вычисление с любой произвольной точностью (интерпретируя получившуюся последовательность символов на ленте как результат, например как двоичное число). Умножение, деление, синусы-косинусы, логарифмы, матрицы, всё что угодно.

2. Не существует способа определить заранее даже то, остановится ли машина в конечном итоге или будет работать вечно, исполняя инструкции по кругу — не говоря уже о том, даст ли набор инструкций правильный результат.

Все компьютеры, от древних больших ламповых до ваших мобильников, работают примерно так же, как машина Тьюринга, с некоторыми несущественными оптимизациями. Просто они делают это _очень_ быстро. Лента — это память, головка и таблица инструкций — это процессор, регистр состояния — часть процессора, так и называется "регистр" (регистров может быть много. Но не очень — обычно их несколько десятков; так работать удобнее, чем с одним).

Заметим, что в оригинальной машине Тьюринга таблица инструкций находится отдельно от ленты с символами, и неизменна. Такое положение дел существует в некоторых микроконтроллерах (встраиваемых компьютерах) — это называется **"гарвардская архитектура"**. Но сам же Тьюринг показал, а после него фон Нейман развил идею, что таблицу инструкций можно изначально хранить на самой же ленте символов. Почти все компьютеры работают именно таким образом, это называется **"фон-неймановская архитектура"**.

Важная концепция: **"тьюринговская универсальность"**. Любая система, которая физически или математически реализует возможность построить машину Тьюринга, может выполнять любые вычисления, разница только в скорости работы. Из этого важное следствие:

Если какую-то задачу можно решить на одном языке программирования, её можно решить и на любом другом. 

Все языки программирования эквивалентны друг другу в "мощности", то есть бесконечном множестве решаемых ими задач. Они различаются только производительностью, удобством работы, и приспособленностью для тех или иных классов решаемых проблем.

Современные настоящие процессоры отличаются от базовой машины Тьюринга тем, что они:

* работают только с двоичными числами, из ноликов и единиц;
* содержат несколько регистров, а не один;
* реализуют с этими регистрами некоторые базовые арифметические действия, а не только перезапись по таблице инструкций. Например, "сложить числа в регистрах A и B, записать результат в регистр A";
* максимальный размер чисел, с которыми работает процессор, ограничен количеством "бит" в регистрах. Современные процессоры, как правило, 64-битные, следовательно, максимальный размер чисел, с которыми они могут работать за один раз — 2 в 64-й степени, а именно 18446744073709551616. Для чисел больше чем это нужно придумывать специальные алгоритмы, осуществляющие арифметические операции последовательно за несколько действий;
* "головка" может двигаться не только на шаг влево и шаг вправо, а в любое место за раз (то есть процессор может читать в регистры и записывать из регистров числа в любое место в памяти, или, как говорят, "по любому адресу");
* по наступлению некоторых внешних событий (например, нажатию клавиши на клавиатуре) процессор может прекращать делать то, что он делал, и выполнить специальную последовательность инструкций, что-то делающую с этим событием (например, записывающую в специальное место в памяти число, соответствующее нажатой клавише). Эта процедура называется "прерывание";
* если процессор записывает числа в специально отведённую область памяти (она называется "видеопамять"), они интерпретируются как пиксели на экране. Например, числа 255, 255, 0, записанные по определённому адресу, закодируют жёлтый цвет, и в соответствующей части монитора загорится жёлтая точка. Подобным же образом устроено взаимодействие и с другими внешними устройствами (например, колонками, издающими звук).

Всё, больше толком ничего процессоры делать не умеют. Это весь компьютер. Он именно настолько тупой.

Писать программу, реализующую машину Тьюринга, мы не будем — это несложно и познавательно, но решать задачи с её помощью довольно нудно. Зато мы будем писать инструкции непосредственно для процессора, который их будет выполнять, не отвлекаясь ни на что другое. Такие инструкции называются "машинный код", а если операции процессора закодировать не числами, которыми он понимает, а текстовыми мнемониками, пригодными для понимания человеком — это будет называться "ассемблерный код", или просто "ассемблер".

Им-то мы завтра и займёмся.
